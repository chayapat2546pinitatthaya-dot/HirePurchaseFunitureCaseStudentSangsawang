{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\sangsawang_furniture_project-master\\\\client\\\\src\\\\pages\\\\ProductDetail.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport Alert from 'react-bootstrap/Alert';\nimport Form from 'react-bootstrap/Form';\nimport axios from 'axios';\nimport { upsertCartItem, notifyCartUpdate } from '../utils/cartApi';\nimport './ProductDetail.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CATEGORY_ITEMS = ['เตียงนอน', 'โซฟา', 'ชั้นวางทีวี', 'โต๊ะเครื่องแป้ง', 'ตู้เสื้อผ้า', 'ฟูกนอน/ที่นอน', 'ตู้โชว์', 'หิ้งพระ', 'ตู้กับข้าว', 'ตู้เสื้อผ้า + โต๊ะเครื่องแป้ง (เซ็ต)'];\nconst ALLOWED_TAGS = CATEGORY_ITEMS;\nconst INSTALLMENT_MIN_PERIODS = 2;\nconst INSTALLMENT_MAX_PERIODS = 12;\nconst DEFAULT_INSTALLMENT_PERIODS = 12;\nconst clampInstallmentPeriods = value => {\n  const numeric = Number(value);\n  if (!Number.isFinite(numeric)) {\n    return INSTALLMENT_MIN_PERIODS;\n  }\n  return Math.min(Math.max(numeric, INSTALLMENT_MIN_PERIODS), INSTALLMENT_MAX_PERIODS);\n};\nconst getInstallmentRateByMonths = (months = DEFAULT_INSTALLMENT_PERIODS) => {\n  const normalized = clampInstallmentPeriods(months);\n  if (normalized === INSTALLMENT_MIN_PERIODS) {\n    return 0.1;\n  }\n  const rate = 0.1 + (normalized - INSTALLMENT_MIN_PERIODS) * 0.01;\n  return Math.min(rate, 0.21);\n};\nconst calculateInstallmentTotalFromCash = (cashPrice, months = DEFAULT_INSTALLMENT_PERIODS) => {\n  const price = Number(cashPrice);\n  if (!Number.isFinite(price) || price <= 0) {\n    return null;\n  }\n  const rate = getInstallmentRateByMonths(months);\n  return price * (1 + rate);\n};\nconst toNumber = value => value != null ? parseFloat(value) : null;\nconst resolveEffectiveCashPrice = productData => {\n  var _ref;\n  if (!productData) {\n    return null;\n  }\n  const cash = toNumber(productData.price_cash);\n  const cashPromo = toNumber(productData.price_cash_promo);\n  if (cashPromo != null && (cash == null || cashPromo < cash)) {\n    return cashPromo;\n  }\n  return (_ref = cash !== null && cash !== void 0 ? cash : cashPromo) !== null && _ref !== void 0 ? _ref : null;\n};\nexport default function ProductDetail() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [product, setProduct] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [alert, setAlert] = useState({\n    show: false,\n    message: '',\n    variant: ''\n  });\n  const [isAdding, setIsAdding] = useState(false);\n  const addStateTimeout = useRef(null);\n  const wiggleTimeout = useRef(null);\n  const [isButtonWiggling, setIsButtonWiggling] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(() => !!localStorage.getItem('token'));\n  const [showLoginOverlay, setShowLoginOverlay] = useState(false);\n  const [activeImageIndex, setActiveImageIndex] = useState(0);\n  const [selectedInstallmentPreview, setSelectedInstallmentPreview] = useState(DEFAULT_INSTALLMENT_PERIODS);\n  const getImageUrl = imagePath => {\n    if (!imagePath || imagePath.trim() === '') {\n      return 'https://via.placeholder.com/800x600?text=ไม่มีรูปภาพ';\n    }\n    const trimmed = String(imagePath).trim();\n\n    // ถ้าเป็น URL แบบเต็ม (http:// หรือ https://) ให้ใช้ตามนั้น\n    if (trimmed.startsWith('http://') || trimmed.startsWith('https://')) {\n      return trimmed;\n    }\n\n    // ดึงรูปภาพจากโฟลเดอร์ images โดยตรงผ่าน static file serving (ไม่ผ่าน API)\n    // ใช้ relative path เพื่อให้ React proxy ทำงาน\n    // สำหรับ path ที่มีอักขระภาษาไทย ต้อง encode แต่ละส่วนของ path\n\n    // ถ้าเป็น path ที่เริ่มต้นด้วย / ให้ encode แต่ละส่วนของ path\n    if (trimmed.startsWith('/')) {\n      try {\n        // แยก path เป็นส่วนๆ และ encode แต่ละส่วน (ยกเว้น / หน้า)\n        const parts = trimmed.split('/').filter(p => p);\n        const encodedParts = parts.map(part => {\n          // Encode แต่ละส่วนของ path เพื่อให้ browser ส่งไปยัง server ถูกต้อง\n          try {\n            return encodeURIComponent(part);\n          } catch (e) {\n            return part;\n          }\n        });\n        return '/' + encodedParts.join('/');\n      } catch (e) {\n        return trimmed;\n      }\n    }\n\n    // ถ้าเป็น path ปกติ ให้แปลงเป็น absolute path\n    if (trimmed.includes('/') || trimmed.includes('\\\\')) {\n      // แปลง backslash เป็น forward slash\n      const normalized = trimmed.replace(/\\\\/g, '/');\n      // ถ้าไม่มี / หน้า ให้เพิ่ม\n      const pathToEncode = normalized.startsWith('/') ? normalized : `/${normalized}`;\n      try {\n        const parts = pathToEncode.split('/').filter(p => p);\n        const encodedParts = parts.map(part => {\n          try {\n            return encodeURIComponent(part);\n          } catch (e) {\n            return part;\n          }\n        });\n        return '/' + encodedParts.join('/');\n      } catch (e) {\n        return pathToEncode;\n      }\n    }\n\n    // ถ้าเป็นแค่ชื่อไฟล์ ให้ encode และใส่ใน /images/\n    try {\n      return `/images/${encodeURIComponent(trimmed)}`;\n    } catch (e) {\n      return `/images/${trimmed}`;\n    }\n  };\n  useEffect(() => {\n    fetchProduct();\n  }, [id]);\n  useEffect(() => {\n    const syncAuthState = () => {\n      setIsAuthenticated(!!localStorage.getItem('token'));\n    };\n    syncAuthState();\n    window.addEventListener('storage', syncAuthState);\n    return () => {\n      window.removeEventListener('storage', syncAuthState);\n    };\n  }, []);\n  useEffect(() => {\n    if (isAuthenticated) {\n      setShowLoginOverlay(false);\n    }\n  }, [isAuthenticated]);\n  const galleryImages = useMemo(() => {\n    if (!product) {\n      return [];\n    }\n    const images = Array.isArray(product.product_images) ? product.product_images.map(img => img == null ? '' : String(img).trim()).filter(Boolean) : [];\n    if (images.length > 0) {\n      return images.slice(0, 4);\n    }\n    return product.product_image ? [product.product_image] : [];\n  }, [product]);\n  useEffect(() => {\n    if (!galleryImages || galleryImages.length === 0) {\n      setActiveImageIndex(0);\n      return;\n    }\n    if (activeImageIndex >= galleryImages.length) {\n      setActiveImageIndex(0);\n    }\n  }, [galleryImages, activeImageIndex]);\n  const activeImageSource = galleryImages[activeImageIndex] || galleryImages[0] || '';\n  const normalizeProductImages = productData => {\n    if (!productData) {\n      return [];\n    }\n    const source = Array.isArray(productData.product_images) ? productData.product_images : productData.product_image ? [productData.product_image] : [];\n    return source.map(item => item == null ? '' : String(item).trim()).filter(Boolean).slice(0, 4);\n  };\n  const prepareProductData = raw => {\n    if (!raw) {\n      return null;\n    }\n    const images = normalizeProductImages(raw);\n    return {\n      ...raw,\n      product_images: images,\n      product_image: images[0] || raw.product_image || ''\n    };\n  };\n  const applyFallbackProduct = () => {\n    // ไม่มี fallback data แล้ว - ใช้ข้อมูลจาก database เท่านั้น\n    setProduct(null);\n    setIsLoading(false);\n  };\n  const fetchProduct = async () => {\n    setIsLoading(true);\n    try {\n      const response = await axios.get(`/api/products/${id}`);\n      if (response.data) {\n        console.log('Product data received:', {\n          product_id: response.data.product_id,\n          product_name: response.data.product_name,\n          product_image: response.data.product_image,\n          product_images: response.data.product_images\n        });\n        const base = {\n          ...response.data,\n          tags: (Array.isArray(response.data.tags) ? response.data.tags : []).filter(tag => ALLOWED_TAGS.includes(tag)).filter((tag, index, self) => self.indexOf(tag) === index),\n          highlights: Array.isArray(response.data.highlights) ? response.data.highlights : []\n        };\n        const normalizedProduct = prepareProductData(base);\n        if (normalizedProduct) {\n          console.log('Normalized product:', {\n            product_image: normalizedProduct.product_image,\n            product_images: normalizedProduct.product_images\n          });\n          setProduct(normalizedProduct);\n          setActiveImageIndex(0);\n          initializePricing(normalizedProduct);\n        } else {\n          console.warn('Failed to normalize product');\n          setProduct(null);\n        }\n      } else {\n        console.warn('No product data received');\n        setProduct(null);\n      }\n    } catch (error) {\n      console.error('Error fetching product:', error);\n      if (error.response && error.response.status === 404) {\n        setProduct(null);\n      } else {\n        setProduct(null);\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const toNumber = value => value != null ? parseFloat(value) : null;\n  const hasRealPromo = (base, promo) => {\n    const baseNum = toNumber(base);\n    const promoNum = toNumber(promo);\n    return baseNum != null && promoNum != null && promoNum < baseNum;\n  };\n  const initializePricing = productData => {\n    // ไม่ต้องตั้งค่า selectedPricing แล้ว เพราะแค่แสดงราคา\n  };\n  const getPricingOptions = productData => {\n    if (!productData) {\n      return [];\n    }\n    const options = [];\n    const hasCashPromo = hasRealPromo(productData.price_cash, productData.price_cash_promo);\n    const hasInstallmentPromo = hasRealPromo(productData.price_installment, productData.price_installment_promo);\n    if (hasCashPromo) {\n      options.push({\n        key: 'cashPromo',\n        label: 'ราคาเต็ม',\n        note: 'โปรโมชัน',\n        amount: productData.price_cash_promo,\n        originalAmount: productData.price_cash,\n        tone: 'promo'\n      });\n    } else if (productData.price_cash != null) {\n      options.push({\n        key: 'cash',\n        label: 'ราคาเต็ม',\n        note: null,\n        amount: productData.price_cash,\n        tone: null\n      });\n    }\n    if (productData.price_installment != null) {\n      if (hasInstallmentPromo) {\n        options.push({\n          key: 'installmentPromo',\n          label: 'ราคาผ่อน',\n          note: 'โปรโมชัน',\n          amount: productData.price_installment_promo,\n          originalAmount: productData.price_installment,\n          tone: 'promo'\n        });\n      } else {\n        options.push({\n          key: 'installment',\n          label: 'ราคาผ่อน',\n          note: null,\n          amount: productData.price_installment,\n          tone: null\n        });\n      }\n    }\n    return options;\n  };\n  const formatPrice = value => {\n    if (value == null) return '-';\n    return `฿${parseFloat(value).toLocaleString()}`;\n  };\n  const formatRoundedInstallment = value => {\n    if (value == null) {\n      return '-';\n    }\n    return `฿${Number(value).toLocaleString('th-TH', {\n      maximumFractionDigits: 0,\n      minimumFractionDigits: 0\n    })}`;\n  };\n  const addProductToCart = async ({\n    withFeedback = true\n  } = {}) => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      if (withFeedback) {\n        setAlert({\n          show: false,\n          message: '',\n          variant: ''\n        });\n      }\n      setShowLoginOverlay(true);\n      if (wiggleTimeout.current) {\n        clearTimeout(wiggleTimeout.current);\n      }\n      setIsButtonWiggling(true);\n      wiggleTimeout.current = setTimeout(() => {\n        setIsButtonWiggling(false);\n      }, 800);\n      return false;\n    }\n    const productId = product.product_id;\n    const pricingOptions = getPricingOptions(product);\n    const activePricing = pricingOptions[0]; // ใช้ราคาแรก (ซื้อสด) เป็นค่าเริ่มต้น\n\n    if (!activePricing) {\n      if (withFeedback) {\n        setAlert({\n          show: true,\n          message: 'ไม่พบข้อมูลราคา กรุณาติดต่อผู้ดูแลระบบ',\n          variant: 'danger'\n        });\n      }\n      return false;\n    }\n    const {\n      key,\n      amount,\n      label\n    } = activePricing;\n    const result = await upsertCartItem({\n      productId,\n      pricingType: key,\n      quantity: 1,\n      unitPrice: amount,\n      pricingLabel: label,\n      mode: 'increment'\n    });\n    if (result.unauthorized) {\n      if (withFeedback) {\n        setAlert({\n          show: false,\n          message: '',\n          variant: ''\n        });\n      }\n      setShowLoginOverlay(true);\n      return false;\n    }\n    if (result.error) {\n      if (withFeedback) {\n        setAlert({\n          show: true,\n          message: 'ไม่สามารถเพิ่มสินค้าในตะกร้าได้ กรุณาลองใหม่อีกครั้ง',\n          variant: 'danger'\n        });\n      }\n      return false;\n    }\n    notifyCartUpdate(result.items);\n    if (withFeedback) {\n      setAlert({\n        show: true,\n        message: 'เพิ่มสินค้าในลิสต์เรียบร้อยแล้ว',\n        variant: 'success'\n      });\n      if (addStateTimeout.current) {\n        clearTimeout(addStateTimeout.current);\n      }\n      setIsAdding(true);\n      addStateTimeout.current = setTimeout(() => {\n        setIsAdding(false);\n      }, 1200);\n    }\n    return true;\n  };\n  const handleAddToCart = async () => {\n    await addProductToCart({\n      withFeedback: true\n    });\n  };\n  const handleBuyNow = async () => {\n    const success = await addProductToCart({\n      withFeedback: false\n    });\n    if (success) {\n      navigate('/cart');\n    }\n  };\n  const handleCloseLoginOverlay = () => {\n    setShowLoginOverlay(false);\n  };\n  useEffect(() => {\n    return () => {\n      if (addStateTimeout.current) {\n        clearTimeout(addStateTimeout.current);\n      }\n      if (wiggleTimeout.current) {\n        clearTimeout(wiggleTimeout.current);\n      }\n    };\n  }, []);\n\n  // Calculate installment pricing - must be before any early returns\n  const effectiveCashPrice = useMemo(() => product ? resolveEffectiveCashPrice(product) : null, [product]);\n  const installmentPreviewTotal = useMemo(() => {\n    if (!effectiveCashPrice) {\n      return null;\n    }\n    return calculateInstallmentTotalFromCash(effectiveCashPrice, selectedInstallmentPreview);\n  }, [effectiveCashPrice, selectedInstallmentPreview]);\n  const installmentPreviewPerMonth = useMemo(() => {\n    if (!installmentPreviewTotal) {\n      return null;\n    }\n    return installmentPreviewTotal / selectedInstallmentPreview;\n  }, [installmentPreviewTotal, selectedInstallmentPreview]);\n  const roundedInstallmentPerMonth = useMemo(() => {\n    if (!installmentPreviewPerMonth) {\n      return null;\n    }\n    const floored = Math.floor(installmentPreviewPerMonth / 10) * 10;\n    return floored;\n  }, [installmentPreviewPerMonth]);\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product-detail-page loading\",\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loading-state\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spinner-border\",\n            role: \"status\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"visually-hidden\",\n              children: \"Loading...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 502,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 501,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 498,\n      columnNumber: 7\n    }, this);\n  }\n  const descriptionLines = product ? (product.product_description || '').split('\\n').map(line => line.trim()).filter(Boolean) : [];\n  const detailItems = product && Array.isArray(product.highlights) && product.highlights.length > 0 ? product.highlights : descriptionLines;\n  const displayTags = product && Array.isArray(product.tags) ? Array.from(new Set(product.tags.filter(tag => ALLOWED_TAGS.includes(tag)))) : [];\n  const pricingOptions = product ? getPricingOptions(product) : [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"product-detail-page\",\n    children: /*#__PURE__*/_jsxDEV(Container, {\n      children: [alert.show && /*#__PURE__*/_jsxDEV(Alert, {\n        variant: alert.variant,\n        dismissible: true,\n        onClose: () => setAlert({\n          show: false\n        }),\n        children: alert.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 531,\n        columnNumber: 11\n      }, this), showLoginOverlay && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `login-overlay${showLoginOverlay ? ' visible' : ''}`,\n        role: \"dialog\",\n        \"aria-modal\": \"true\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overlay-backdrop\",\n          onClick: handleCloseLoginOverlay\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 538,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overlay-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"overlay-close\",\n            onClick: handleCloseLoginOverlay,\n            \"aria-label\": \"\\u0E1B\\u0E34\\u0E14\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"bi bi-x-lg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 541,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"overlay-icon\",\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"bi bi-shield-lock\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 543,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E25\\u0E34\\u0E2A\\u0E15\\u0E4C\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 546,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u0E1A\\u0E31\\u0E0D\\u0E0A\\u0E35\\u0E2A\\u0E21\\u0E32\\u0E0A\\u0E34\\u0E01\\u0E0A\\u0E48\\u0E27\\u0E22\\u0E43\\u0E2B\\u0E49\\u0E04\\u0E38\\u0E13\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\\u0E17\\u0E35\\u0E48\\u0E0A\\u0E2D\\u0E1A \\u0E1A\\u0E23\\u0E34\\u0E2B\\u0E32\\u0E23\\u0E04\\u0E33\\u0E2A\\u0E31\\u0E48\\u0E07\\u0E0B\\u0E37\\u0E49\\u0E2D\\u0E44\\u0E14\\u0E49\\u0E2A\\u0E30\\u0E14\\u0E27\\u0E01 \\u0E41\\u0E25\\u0E30\\u0E15\\u0E34\\u0E14\\u0E15\\u0E32\\u0E21\\u0E42\\u0E1B\\u0E23\\u0E42\\u0E21\\u0E0A\\u0E31\\u0E48\\u0E19\\u0E17\\u0E35\\u0E48\\u0E40\\u0E2B\\u0E21\\u0E32\\u0E30\\u0E01\\u0E31\\u0E1A\\u0E04\\u0E38\\u0E13\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"overlay-actions\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-primary-custom\",\n              size: \"lg\",\n              onClick: () => navigate('/login'),\n              children: \"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 551,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"light\",\n              size: \"lg\",\n              onClick: () => navigate('/register'),\n              children: \"\\u0E2A\\u0E21\\u0E31\\u0E04\\u0E23\\u0E2A\\u0E21\\u0E32\\u0E0A\\u0E34\\u0E01\\u0E43\\u0E2B\\u0E21\\u0E48\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 550,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 537,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"detail-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail-gallery\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"gallery-main\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: getImageUrl(activeImageSource),\n              alt: product.product_name,\n              onError: e => {\n                console.error('Image load error:', getImageUrl(activeImageSource));\n                e.target.src = 'https://via.placeholder.com/800x600?text=ไม่พบรูปภาพ';\n              },\n              onLoad: () => {\n                console.log('Image loaded successfully:', getImageUrl(activeImageSource));\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 565,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 13\n          }, this), galleryImages.length > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"gallery-thumbs\",\n            children: galleryImages.map((image, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: `gallery-thumb${index === activeImageIndex ? ' active' : ''}`,\n              onClick: () => setActiveImageIndex(index),\n              \"aria-label\": `ดูภาพสินค้า ${index + 1}`,\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: getImageUrl(image),\n                alt: `${product.product_name} - ภาพที่ ${index + 1}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 587,\n                columnNumber: 21\n              }, this)\n            }, `${image}-${index}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 580,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"gallery-note\",\n            children: \"\\u0E20\\u0E32\\u0E1E\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\\u0E43\\u0E0A\\u0E49\\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E01\\u0E32\\u0E23\\u0E42\\u0E06\\u0E29\\u0E13\\u0E32 \\u0E2A\\u0E35\\u0E2D\\u0E32\\u0E08\\u0E41\\u0E15\\u0E01\\u0E15\\u0E48\\u0E32\\u0E07\\u0E08\\u0E32\\u0E01\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\\u0E08\\u0E23\\u0E34\\u0E07\\u0E40\\u0E25\\u0E47\\u0E01\\u0E19\\u0E49\\u0E2D\\u0E22\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 592,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 563,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"detail-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: product.product_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 596,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"detail-description\",\n            children: descriptionLines.length > 0 ? descriptionLines[0] : 'สินค้าเฟอร์นิเจอร์คุณภาพจากแสงสว่างเฟอร์นิเจอร์'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-price-box\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"price-label\",\n              children: \"\\u0E23\\u0E32\\u0E04\\u0E32\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pricing-cards\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pricing-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pricing-card__header\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"pricing-label\",\n                    children: \"\\u0E23\\u0E32\\u0E04\\u0E32\\u0E40\\u0E15\\u0E47\\u0E21\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 606,\n                    columnNumber: 23\n                  }, this), hasRealPromo(product === null || product === void 0 ? void 0 : product.price_cash, product === null || product === void 0 ? void 0 : product.price_cash_promo) && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"pricing-note\",\n                    children: \"\\u0E42\\u0E1B\\u0E23\\u0E42\\u0E21\\u0E0A\\u0E31\\u0E19\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 608,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 605,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pricing-card__value\",\n                  children: formatPrice(hasRealPromo(product === null || product === void 0 ? void 0 : product.price_cash, product === null || product === void 0 ? void 0 : product.price_cash_promo) ? product === null || product === void 0 ? void 0 : product.price_cash_promo : product === null || product === void 0 ? void 0 : product.price_cash)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 611,\n                  columnNumber: 21\n                }, this), hasRealPromo(product === null || product === void 0 ? void 0 : product.price_cash, product === null || product === void 0 ? void 0 : product.price_cash_promo) && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pricing-card__original\",\n                  children: formatPrice(product === null || product === void 0 ? void 0 : product.price_cash)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 619,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 604,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pricing-card pricing-card--installment\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pricing-card__header\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"pricing-label\",\n                    children: \"\\u0E23\\u0E32\\u0E04\\u0E32\\u0E1C\\u0E48\\u0E2D\\u0E19\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 624,\n                    columnNumber: 23\n                  }, this), hasRealPromo(product === null || product === void 0 ? void 0 : product.price_installment, product === null || product === void 0 ? void 0 : product.price_installment_promo) && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"pricing-note\",\n                    children: \"\\u0E42\\u0E1B\\u0E23\\u0E42\\u0E21\\u0E0A\\u0E31\\u0E19\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 626,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 623,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pricing-card__value\",\n                  children: [formatRoundedInstallment(roundedInstallmentPerMonth), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"pricing-card__per-month\",\n                    children: \"/ \\u0E40\\u0E14\\u0E37\\u0E2D\\u0E19\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 631,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 629,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"installment-selector\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"previewInstallment\",\n                    children: \"\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E07\\u0E27\\u0E14\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 634,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n                    id: \"previewInstallment\",\n                    value: selectedInstallmentPreview,\n                    onChange: event => setSelectedInstallmentPreview(clampInstallmentPeriods(event.target.value)),\n                    children: Array.from({\n                      length: INSTALLMENT_MAX_PERIODS - INSTALLMENT_MIN_PERIODS + 1\n                    }, (_, idx) => INSTALLMENT_MIN_PERIODS + idx).map(period => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: period,\n                      children: [period, \" \\u0E07\\u0E27\\u0E14\"]\n                    }, period, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 646,\n                      columnNumber: 27\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 635,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 633,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 622,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 603,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 601,\n            columnNumber: 13\n          }, this), displayTags.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-tags\",\n            children: displayTags.map(tag => /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"tag-badge\",\n              children: [\"#\", tag]\n            }, tag, true, {\n              fileName: _jsxFileName,\n              lineNumber: 659,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 657,\n            columnNumber: 17\n          }, this), detailItems && detailItems.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-list\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 668,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: detailItems.map((item, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: item\n              }, idx, false, {\n                fileName: _jsxFileName,\n                lineNumber: 671,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 669,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 667,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-actions\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              variant: \"light\",\n              className: \"btn-outline buy-now-btn\",\n              size: \"lg\",\n              onClick: handleBuyNow,\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-bag-check me-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 684,\n                columnNumber: 17\n              }, this), \"\\u0E0B\\u0E37\\u0E49\\u0E2D\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 678,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              className: `btn-primary-custom add-to-cart-btn${isAdding ? ' added' : ''}${!isAuthenticated ? ' needs-login' : ''}${isButtonWiggling ? ' wiggle' : ''}`,\n              size: \"lg\",\n              onClick: handleAddToCart,\n              disabled: isAdding,\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: `bi ${isAdding ? 'bi-check-circle' : 'bi-cart-plus'} me-2`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 693,\n                columnNumber: 17\n              }, this), isAuthenticated ? isAdding ? 'เพิ่มแล้ว!' : 'เพิ่มลงตะกร้า' : 'เข้าสู่ระบบก่อนเพิ่ม']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 687,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 677,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-meta\",\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              children: /*#__PURE__*/_jsxDEV(Card.Body, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0E1A\\u0E23\\u0E34\\u0E01\\u0E32\\u0E23\\u0E08\\u0E31\\u0E14\\u0E2A\\u0E48\\u0E07\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 702,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u0E1F\\u0E23\\u0E35\\u0E43\\u0E19\\u0E40\\u0E02\\u0E15\\u0E01\\u0E23\\u0E38\\u0E07\\u0E40\\u0E17\\u0E1E\\u0E2F \\u0E41\\u0E25\\u0E30\\u0E1B\\u0E23\\u0E34\\u0E21\\u0E13\\u0E11\\u0E25\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 703,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 701,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0E01\\u0E32\\u0E23\\u0E23\\u0E31\\u0E1A\\u0E1B\\u0E23\\u0E30\\u0E01\\u0E31\\u0E19\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 706,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u0E42\\u0E04\\u0E23\\u0E07\\u0E2A\\u0E23\\u0E49\\u0E32\\u0E07 3 \\u0E1B\\u0E35 / \\u0E01\\u0E25\\u0E44\\u0E01 1 \\u0E1B\\u0E35\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 707,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 705,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0E23\\u0E30\\u0E22\\u0E30\\u0E40\\u0E27\\u0E25\\u0E32\\u0E01\\u0E32\\u0E23\\u0E1C\\u0E48\\u0E2D\\u0E19\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 710,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u0E1C\\u0E48\\u0E2D\\u0E19\\u0E44\\u0E14\\u0E49\\u0E15\\u0E31\\u0E49\\u0E07\\u0E41\\u0E15\\u0E48 2 \\u0E40\\u0E14\\u0E37\\u0E2D\\u0E19\\u0E08\\u0E19\\u0E16\\u0E36\\u0E07 12 \\u0E40\\u0E14\\u0E37\\u0E2D\\u0E19\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 711,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 709,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 700,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 699,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 698,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 562,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 529,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 528,\n    columnNumber: 5\n  }, this);\n}\n_s(ProductDetail, \"RtZ42zU4gZf67q3vYtbnJghcSVw=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ProductDetail;\nvar _c;\n$RefreshReg$(_c, \"ProductDetail\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","useParams","useNavigate","Container","Row","Col","Card","Button","Alert","Form","axios","upsertCartItem","notifyCartUpdate","jsxDEV","_jsxDEV","CATEGORY_ITEMS","ALLOWED_TAGS","INSTALLMENT_MIN_PERIODS","INSTALLMENT_MAX_PERIODS","DEFAULT_INSTALLMENT_PERIODS","clampInstallmentPeriods","value","numeric","Number","isFinite","Math","min","max","getInstallmentRateByMonths","months","normalized","rate","calculateInstallmentTotalFromCash","cashPrice","price","toNumber","parseFloat","resolveEffectiveCashPrice","productData","_ref","cash","price_cash","cashPromo","price_cash_promo","ProductDetail","_s","id","navigate","product","setProduct","isLoading","setIsLoading","alert","setAlert","show","message","variant","isAdding","setIsAdding","addStateTimeout","wiggleTimeout","isButtonWiggling","setIsButtonWiggling","isAuthenticated","setIsAuthenticated","localStorage","getItem","showLoginOverlay","setShowLoginOverlay","activeImageIndex","setActiveImageIndex","selectedInstallmentPreview","setSelectedInstallmentPreview","getImageUrl","imagePath","trim","trimmed","String","startsWith","parts","split","filter","p","encodedParts","map","part","encodeURIComponent","e","join","includes","replace","pathToEncode","fetchProduct","syncAuthState","window","addEventListener","removeEventListener","galleryImages","images","Array","isArray","product_images","img","Boolean","length","slice","product_image","activeImageSource","normalizeProductImages","source","item","prepareProductData","raw","applyFallbackProduct","response","get","data","console","log","product_id","product_name","base","tags","tag","index","self","indexOf","highlights","normalizedProduct","initializePricing","warn","error","status","hasRealPromo","promo","baseNum","promoNum","getPricingOptions","options","hasCashPromo","hasInstallmentPromo","price_installment","price_installment_promo","push","key","label","note","amount","originalAmount","tone","formatPrice","toLocaleString","formatRoundedInstallment","maximumFractionDigits","minimumFractionDigits","addProductToCart","withFeedback","token","current","clearTimeout","setTimeout","productId","pricingOptions","activePricing","result","pricingType","quantity","unitPrice","pricingLabel","mode","unauthorized","items","handleAddToCart","handleBuyNow","success","handleCloseLoginOverlay","effectiveCashPrice","installmentPreviewTotal","installmentPreviewPerMonth","roundedInstallmentPerMonth","floored","floor","className","children","role","fileName","_jsxFileName","lineNumber","columnNumber","descriptionLines","product_description","line","detailItems","displayTags","from","Set","dismissible","onClose","onClick","type","size","src","alt","onError","target","onLoad","image","htmlFor","Select","onChange","event","_","idx","period","disabled","Body","_c","$RefreshReg$"],"sources":["C:/xampp/htdocs/sangsawang_furniture_project-master/client/src/pages/ProductDetail.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport Alert from 'react-bootstrap/Alert';\nimport Form from 'react-bootstrap/Form';\nimport axios from 'axios';\nimport { upsertCartItem, notifyCartUpdate } from '../utils/cartApi';\nimport './ProductDetail.css';\n\nconst CATEGORY_ITEMS = [\n  'เตียงนอน',\n  'โซฟา',\n  'ชั้นวางทีวี',\n  'โต๊ะเครื่องแป้ง',\n  'ตู้เสื้อผ้า',\n  'ฟูกนอน/ที่นอน',\n  'ตู้โชว์',\n  'หิ้งพระ',\n  'ตู้กับข้าว',\n  'ตู้เสื้อผ้า + โต๊ะเครื่องแป้ง (เซ็ต)'\n];\n\nconst ALLOWED_TAGS = CATEGORY_ITEMS;\n\nconst INSTALLMENT_MIN_PERIODS = 2;\nconst INSTALLMENT_MAX_PERIODS = 12;\nconst DEFAULT_INSTALLMENT_PERIODS = 12;\n\nconst clampInstallmentPeriods = (value) => {\n  const numeric = Number(value);\n  if (!Number.isFinite(numeric)) {\n    return INSTALLMENT_MIN_PERIODS;\n  }\n  return Math.min(Math.max(numeric, INSTALLMENT_MIN_PERIODS), INSTALLMENT_MAX_PERIODS);\n};\n\nconst getInstallmentRateByMonths = (months = DEFAULT_INSTALLMENT_PERIODS) => {\n  const normalized = clampInstallmentPeriods(months);\n  if (normalized === INSTALLMENT_MIN_PERIODS) {\n    return 0.1;\n  }\n  const rate = 0.1 + (normalized - INSTALLMENT_MIN_PERIODS) * 0.01;\n  return Math.min(rate, 0.21);\n};\n\nconst calculateInstallmentTotalFromCash = (cashPrice, months = DEFAULT_INSTALLMENT_PERIODS) => {\n  const price = Number(cashPrice);\n  if (!Number.isFinite(price) || price <= 0) {\n    return null;\n  }\n  const rate = getInstallmentRateByMonths(months);\n  return price * (1 + rate);\n};\n\nconst toNumber = (value) => (value != null ? parseFloat(value) : null);\nconst resolveEffectiveCashPrice = (productData) => {\n  if (!productData) {\n    return null;\n  }\n  const cash = toNumber(productData.price_cash);\n  const cashPromo = toNumber(productData.price_cash_promo);\n  if (cashPromo != null && (cash == null || cashPromo < cash)) {\n    return cashPromo;\n  }\n  return cash ?? cashPromo ?? null;\n};\n\nexport default function ProductDetail() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [product, setProduct] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [alert, setAlert] = useState({ show: false, message: '', variant: '' });\n  const [isAdding, setIsAdding] = useState(false);\n  const addStateTimeout = useRef(null);\n  const wiggleTimeout = useRef(null);\n  const [isButtonWiggling, setIsButtonWiggling] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(() => !!localStorage.getItem('token'));\n  const [showLoginOverlay, setShowLoginOverlay] = useState(false);\n  const [activeImageIndex, setActiveImageIndex] = useState(0);\n  const [selectedInstallmentPreview, setSelectedInstallmentPreview] = useState(\n    DEFAULT_INSTALLMENT_PERIODS\n  );\n\n  const getImageUrl = (imagePath) => {\n    if (!imagePath || imagePath.trim() === '') {\n      return 'https://via.placeholder.com/800x600?text=ไม่มีรูปภาพ';\n    }\n    const trimmed = String(imagePath).trim();\n    \n    // ถ้าเป็น URL แบบเต็ม (http:// หรือ https://) ให้ใช้ตามนั้น\n    if (trimmed.startsWith('http://') || trimmed.startsWith('https://')) {\n      return trimmed;\n    }\n    \n    // ดึงรูปภาพจากโฟลเดอร์ images โดยตรงผ่าน static file serving (ไม่ผ่าน API)\n    // ใช้ relative path เพื่อให้ React proxy ทำงาน\n    // สำหรับ path ที่มีอักขระภาษาไทย ต้อง encode แต่ละส่วนของ path\n    \n    // ถ้าเป็น path ที่เริ่มต้นด้วย / ให้ encode แต่ละส่วนของ path\n    if (trimmed.startsWith('/')) {\n      try {\n        // แยก path เป็นส่วนๆ และ encode แต่ละส่วน (ยกเว้น / หน้า)\n        const parts = trimmed.split('/').filter(p => p);\n        const encodedParts = parts.map(part => {\n          // Encode แต่ละส่วนของ path เพื่อให้ browser ส่งไปยัง server ถูกต้อง\n          try {\n            return encodeURIComponent(part);\n          } catch (e) {\n            return part;\n          }\n        });\n        return '/' + encodedParts.join('/');\n      } catch (e) {\n        return trimmed;\n      }\n    }\n    \n    // ถ้าเป็น path ปกติ ให้แปลงเป็น absolute path\n    if (trimmed.includes('/') || trimmed.includes('\\\\')) {\n      // แปลง backslash เป็น forward slash\n      const normalized = trimmed.replace(/\\\\/g, '/');\n      // ถ้าไม่มี / หน้า ให้เพิ่ม\n      const pathToEncode = normalized.startsWith('/') ? normalized : `/${normalized}`;\n      try {\n        const parts = pathToEncode.split('/').filter(p => p);\n        const encodedParts = parts.map(part => {\n          try {\n            return encodeURIComponent(part);\n          } catch (e) {\n            return part;\n          }\n        });\n        return '/' + encodedParts.join('/');\n      } catch (e) {\n        return pathToEncode;\n      }\n    }\n    \n    // ถ้าเป็นแค่ชื่อไฟล์ ให้ encode และใส่ใน /images/\n    try {\n      return `/images/${encodeURIComponent(trimmed)}`;\n    } catch (e) {\n      return `/images/${trimmed}`;\n    }\n  };\n\n  useEffect(() => {\n    fetchProduct();\n  }, [id]);\n\n  useEffect(() => {\n    const syncAuthState = () => {\n      setIsAuthenticated(!!localStorage.getItem('token'));\n    };\n    syncAuthState();\n    window.addEventListener('storage', syncAuthState);\n    return () => {\n      window.removeEventListener('storage', syncAuthState);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      setShowLoginOverlay(false);\n    }\n  }, [isAuthenticated]);\n\n\n  const galleryImages = useMemo(() => {\n    if (!product) {\n      return [];\n    }\n    const images = Array.isArray(product.product_images)\n      ? product.product_images\n          .map((img) => (img == null ? '' : String(img).trim()))\n          .filter(Boolean)\n      : [];\n    if (images.length > 0) {\n      return images.slice(0, 4);\n    }\n    return product.product_image ? [product.product_image] : [];\n  }, [product]);\n\n  useEffect(() => {\n    if (!galleryImages || galleryImages.length === 0) {\n      setActiveImageIndex(0);\n      return;\n    }\n    if (activeImageIndex >= galleryImages.length) {\n      setActiveImageIndex(0);\n    }\n  }, [galleryImages, activeImageIndex]);\n\n  const activeImageSource = galleryImages[activeImageIndex] || galleryImages[0] || '';\n\n  const normalizeProductImages = (productData) => {\n    if (!productData) {\n      return [];\n    }\n    const source = Array.isArray(productData.product_images)\n      ? productData.product_images\n      : productData.product_image\n      ? [productData.product_image]\n      : [];\n    return source\n      .map((item) => (item == null ? '' : String(item).trim()))\n      .filter(Boolean)\n      .slice(0, 4);\n  };\n\n  const prepareProductData = (raw) => {\n    if (!raw) {\n      return null;\n    }\n    const images = normalizeProductImages(raw);\n    return {\n      ...raw,\n      product_images: images,\n      product_image: images[0] || raw.product_image || ''\n    };\n  };\n\n  const applyFallbackProduct = () => {\n    // ไม่มี fallback data แล้ว - ใช้ข้อมูลจาก database เท่านั้น\n    setProduct(null);\n    setIsLoading(false);\n  };\n\n  const fetchProduct = async () => {\n    setIsLoading(true);\n    try {\n      const response = await axios.get(`/api/products/${id}`);\n      if (response.data) {\n        console.log('Product data received:', {\n          product_id: response.data.product_id,\n          product_name: response.data.product_name,\n          product_image: response.data.product_image,\n          product_images: response.data.product_images\n        });\n        const base = {\n          ...response.data,\n          tags: (Array.isArray(response.data.tags) ? response.data.tags : [])\n            .filter((tag) => ALLOWED_TAGS.includes(tag))\n            .filter((tag, index, self) => self.indexOf(tag) === index),\n          highlights: Array.isArray(response.data.highlights)\n            ? response.data.highlights\n            : []\n        };\n        const normalizedProduct = prepareProductData(base);\n        if (normalizedProduct) {\n          console.log('Normalized product:', {\n            product_image: normalizedProduct.product_image,\n            product_images: normalizedProduct.product_images\n          });\n          setProduct(normalizedProduct);\n          setActiveImageIndex(0);\n          initializePricing(normalizedProduct);\n        } else {\n          console.warn('Failed to normalize product');\n          setProduct(null);\n        }\n      } else {\n        console.warn('No product data received');\n        setProduct(null);\n      }\n    } catch (error) {\n      console.error('Error fetching product:', error);\n      if (error.response && error.response.status === 404) {\n        setProduct(null);\n      } else {\n        setProduct(null);\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const toNumber = (value) => (value != null ? parseFloat(value) : null);\n\n  const hasRealPromo = (base, promo) => {\n    const baseNum = toNumber(base);\n    const promoNum = toNumber(promo);\n    return baseNum != null && promoNum != null && promoNum < baseNum;\n  };\n\n  const initializePricing = (productData) => {\n    // ไม่ต้องตั้งค่า selectedPricing แล้ว เพราะแค่แสดงราคา\n  };\n\n  const getPricingOptions = (productData) => {\n    if (!productData) {\n      return [];\n    }\n \n    const options = [];\n \n    const hasCashPromo = hasRealPromo(productData.price_cash, productData.price_cash_promo);\n    const hasInstallmentPromo = hasRealPromo(\n      productData.price_installment,\n      productData.price_installment_promo\n    );\n\n    if (hasCashPromo) {\n      options.push({\n        key: 'cashPromo',\n        label: 'ราคาเต็ม',\n        note: 'โปรโมชัน',\n        amount: productData.price_cash_promo,\n        originalAmount: productData.price_cash,\n        tone: 'promo'\n      });\n    } else if (productData.price_cash != null) {\n      options.push({\n        key: 'cash',\n        label: 'ราคาเต็ม',\n        note: null,\n        amount: productData.price_cash,\n        tone: null\n      });\n    }\n \n    if (productData.price_installment != null) {\n      if (hasInstallmentPromo) {\n        options.push({\n          key: 'installmentPromo',\n        label: 'ราคาผ่อน',\n          note: 'โปรโมชัน',\n          amount: productData.price_installment_promo,\n          originalAmount: productData.price_installment,\n          tone: 'promo'\n        });\n      } else {\n        options.push({\n          key: 'installment',\n        label: 'ราคาผ่อน',\n          note: null,\n          amount: productData.price_installment,\n          tone: null\n        });\n      }\n    }\n \n    return options;\n  };\n\n  const formatPrice = (value) => {\n    if (value == null) return '-';\n    return `฿${parseFloat(value).toLocaleString()}`;\n  };\n\n  const formatRoundedInstallment = (value) => {\n    if (value == null) {\n      return '-';\n    }\n    return `฿${Number(value).toLocaleString('th-TH', {\n      maximumFractionDigits: 0,\n      minimumFractionDigits: 0\n    })}`;\n  };\n\n  const addProductToCart = async ({ withFeedback = true } = {}) => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      if (withFeedback) {\n        setAlert({ show: false, message: '', variant: '' });\n      }\n      setShowLoginOverlay(true);\n      if (wiggleTimeout.current) {\n        clearTimeout(wiggleTimeout.current);\n      }\n      setIsButtonWiggling(true);\n      wiggleTimeout.current = setTimeout(() => {\n        setIsButtonWiggling(false);\n      }, 800);\n      return false;\n    }\n\n    const productId = product.product_id;\n    const pricingOptions = getPricingOptions(product);\n    const activePricing = pricingOptions[0]; // ใช้ราคาแรก (ซื้อสด) เป็นค่าเริ่มต้น\n\n    if (!activePricing) {\n      if (withFeedback) {\n        setAlert({\n          show: true,\n          message: 'ไม่พบข้อมูลราคา กรุณาติดต่อผู้ดูแลระบบ',\n          variant: 'danger'\n        });\n      }\n      return false;\n    }\n\n    const { key, amount, label } = activePricing;\n    const result = await upsertCartItem({\n      productId,\n      pricingType: key,\n      quantity: 1,\n      unitPrice: amount,\n      pricingLabel: label,\n      mode: 'increment'\n    });\n\n    if (result.unauthorized) {\n      if (withFeedback) {\n        setAlert({ show: false, message: '', variant: '' });\n      }\n      setShowLoginOverlay(true);\n      return false;\n    }\n\n    if (result.error) {\n      if (withFeedback) {\n        setAlert({\n          show: true,\n          message: 'ไม่สามารถเพิ่มสินค้าในตะกร้าได้ กรุณาลองใหม่อีกครั้ง',\n          variant: 'danger'\n        });\n      }\n      return false;\n    }\n\n    notifyCartUpdate(result.items);\n    if (withFeedback) {\n      setAlert({\n        show: true,\n        message: 'เพิ่มสินค้าในลิสต์เรียบร้อยแล้ว',\n        variant: 'success'\n      });\n      if (addStateTimeout.current) {\n        clearTimeout(addStateTimeout.current);\n      }\n      setIsAdding(true);\n      addStateTimeout.current = setTimeout(() => {\n        setIsAdding(false);\n      }, 1200);\n    }\n    return true;\n  };\n\n  const handleAddToCart = async () => {\n    await addProductToCart({ withFeedback: true });\n  };\n\n  const handleBuyNow = async () => {\n    const success = await addProductToCart({ withFeedback: false });\n    if (success) {\n      navigate('/cart');\n    }\n  };\n\n  const handleCloseLoginOverlay = () => {\n    setShowLoginOverlay(false);\n  };\n\n  useEffect(() => {\n    return () => {\n      if (addStateTimeout.current) {\n        clearTimeout(addStateTimeout.current);\n      }\n      if (wiggleTimeout.current) {\n        clearTimeout(wiggleTimeout.current);\n      }\n    };\n  }, []);\n\n  // Calculate installment pricing - must be before any early returns\n  const effectiveCashPrice = useMemo(\n    () => (product ? resolveEffectiveCashPrice(product) : null),\n    [product]\n  );\n  const installmentPreviewTotal = useMemo(() => {\n    if (!effectiveCashPrice) {\n      return null;\n    }\n    return calculateInstallmentTotalFromCash(effectiveCashPrice, selectedInstallmentPreview);\n  }, [effectiveCashPrice, selectedInstallmentPreview]);\n  const installmentPreviewPerMonth = useMemo(() => {\n    if (!installmentPreviewTotal) {\n      return null;\n    }\n    return installmentPreviewTotal / selectedInstallmentPreview;\n  }, [installmentPreviewTotal, selectedInstallmentPreview]);\n  const roundedInstallmentPerMonth = useMemo(() => {\n    if (!installmentPreviewPerMonth) {\n      return null;\n    }\n    const floored = Math.floor(installmentPreviewPerMonth / 10) * 10;\n    return floored;\n  }, [installmentPreviewPerMonth]);\n\n  if (isLoading) {\n    return (\n      <div className=\"product-detail-page loading\">\n        <Container>\n          <div className=\"loading-state\">\n            <div className=\"spinner-border\" role=\"status\">\n              <span className=\"visually-hidden\">Loading...</span>\n            </div>\n          </div>\n        </Container>\n      </div>\n    );\n  }\n\n  const descriptionLines = product\n    ? (product.product_description || '')\n        .split('\\n')\n        .map((line) => line.trim())\n        .filter(Boolean)\n    : [];\n\n  const detailItems =\n    product && Array.isArray(product.highlights) && product.highlights.length > 0\n      ? product.highlights\n      : descriptionLines;\n  const displayTags =\n    product && Array.isArray(product.tags)\n      ? Array.from(new Set(product.tags.filter((tag) => ALLOWED_TAGS.includes(tag))))\n      : [];\n  const pricingOptions = product ? getPricingOptions(product) : [];\n\n  return (\n    <div className=\"product-detail-page\">\n      <Container>\n        {alert.show && (\n          <Alert variant={alert.variant} dismissible onClose={() => setAlert({ show: false })}>\n            {alert.message}\n          </Alert>\n        )}\n\n        {showLoginOverlay && (\n          <div className={`login-overlay${showLoginOverlay ? ' visible' : ''}`} role=\"dialog\" aria-modal=\"true\">\n            <div className=\"overlay-backdrop\" onClick={handleCloseLoginOverlay}></div>\n            <div className=\"overlay-card\">\n              <button type=\"button\" className=\"overlay-close\" onClick={handleCloseLoginOverlay} aria-label=\"ปิด\">\n                <i className=\"bi bi-x-lg\"></i>\n              </button>\n              <div className=\"overlay-icon\">\n                <i className=\"bi bi-shield-lock\"></i>\n              </div>\n              <h3>เข้าสู่ระบบเพื่อบันทึกลิสต์สินค้า</h3>\n              <p>\n                บัญชีสมาชิกช่วยให้คุณบันทึกรายการที่ชอบ บริหารคำสั่งซื้อได้สะดวก และติดตามโปรโมชั่นที่เหมาะกับคุณ\n              </p>\n              <div className=\"overlay-actions\">\n                <Button className=\"btn-primary-custom\" size=\"lg\" onClick={() => navigate('/login')}>\n                  เข้าสู่ระบบ\n                </Button>\n                <Button variant=\"light\" size=\"lg\" onClick={() => navigate('/register')}>\n                  สมัครสมาชิกใหม่\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"detail-wrapper\">\n          <div className=\"detail-gallery\">\n            <div className=\"gallery-main\">\n              <img \n                src={getImageUrl(activeImageSource)} \n                alt={product.product_name}\n                onError={(e) => {\n                  console.error('Image load error:', getImageUrl(activeImageSource));\n                  e.target.src = 'https://via.placeholder.com/800x600?text=ไม่พบรูปภาพ';\n                }}\n                onLoad={() => {\n                  console.log('Image loaded successfully:', getImageUrl(activeImageSource));\n                }}\n              />\n            </div>\n            {galleryImages.length > 1 && (\n              <div className=\"gallery-thumbs\">\n                {galleryImages.map((image, index) => (\n                  <button\n                    key={`${image}-${index}`}\n                    type=\"button\"\n                    className={`gallery-thumb${index === activeImageIndex ? ' active' : ''}`}\n                    onClick={() => setActiveImageIndex(index)}\n                    aria-label={`ดูภาพสินค้า ${index + 1}`}\n                  >\n                    <img src={getImageUrl(image)} alt={`${product.product_name} - ภาพที่ ${index + 1}`} />\n                  </button>\n                ))}\n              </div>\n            )}\n            <div className=\"gallery-note\">ภาพสินค้าใช้เพื่อการโฆษณา สีอาจแตกต่างจากสินค้าจริงเล็กน้อย</div>\n          </div>\n\n          <div className=\"detail-content\">\n            <h1>{product.product_name}</h1>\n            <p className=\"detail-description\">\n              {descriptionLines.length > 0 ? descriptionLines[0] : 'สินค้าเฟอร์นิเจอร์คุณภาพจากแสงสว่างเฟอร์นิเจอร์'}\n            </p>\n\n            <div className=\"detail-price-box\">\n                <span className=\"price-label\">ราคาสินค้า</span>\n                <div className=\"pricing-cards\">\n                  <div className=\"pricing-card\">\n                    <div className=\"pricing-card__header\">\n                      <span className=\"pricing-label\">ราคาเต็ม</span>\n                      {hasRealPromo(product?.price_cash, product?.price_cash_promo) && (\n                        <span className=\"pricing-note\">โปรโมชัน</span>\n                      )}\n                    </div>\n                    <div className=\"pricing-card__value\">\n                      {formatPrice(\n                        hasRealPromo(product?.price_cash, product?.price_cash_promo)\n                          ? product?.price_cash_promo\n                          : product?.price_cash\n                      )}\n                    </div>\n                    {hasRealPromo(product?.price_cash, product?.price_cash_promo) && (\n                      <div className=\"pricing-card__original\">{formatPrice(product?.price_cash)}</div>\n                    )}\n                  </div>\n                  <div className=\"pricing-card pricing-card--installment\">\n                    <div className=\"pricing-card__header\">\n                      <span className=\"pricing-label\">ราคาผ่อน</span>\n                      {hasRealPromo(product?.price_installment, product?.price_installment_promo) && (\n                        <span className=\"pricing-note\">โปรโมชัน</span>\n                      )}\n                    </div>\n                    <div className=\"pricing-card__value\">\n                    {formatRoundedInstallment(roundedInstallmentPerMonth)}\n                      <span className=\"pricing-card__per-month\">/ เดือน</span>\n                    </div>\n                    <div className=\"installment-selector\">\n                      <label htmlFor=\"previewInstallment\">จำนวนงวด</label>\n                      <Form.Select\n                        id=\"previewInstallment\"\n                        value={selectedInstallmentPreview}\n                        onChange={(event) =>\n                          setSelectedInstallmentPreview(clampInstallmentPeriods(event.target.value))\n                        }\n                      >\n                        {Array.from(\n                          { length: INSTALLMENT_MAX_PERIODS - INSTALLMENT_MIN_PERIODS + 1 },\n                          (_, idx) => INSTALLMENT_MIN_PERIODS + idx\n                        ).map((period) => (\n                          <option key={period} value={period}>\n                            {period} งวด\n                          </option>\n                        ))}\n                      </Form.Select>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {displayTags.length > 0 && (\n                <div className=\"detail-tags\">\n                  {displayTags.map((tag) => (\n                    <span key={tag} className=\"tag-badge\">\n                      #{tag}\n                    </span>\n                  ))}\n                </div>\n              )}\n\n            {detailItems && detailItems.length > 0 && (\n              <div className=\"detail-list\">\n                <h3>รายละเอียดสินค้า</h3>\n                <ul>\n                  {detailItems.map((item, idx) => (\n                    <li key={idx}>{item}</li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            <div className=\"detail-actions\">\n              <Button\n                variant=\"light\"\n                className=\"btn-outline buy-now-btn\"\n                size=\"lg\"\n                onClick={handleBuyNow}\n              >\n                <i className=\"bi bi-bag-check me-2\"></i>\n                ซื้อสินค้า\n              </Button>\n              <Button\n                className={`btn-primary-custom add-to-cart-btn${isAdding ? ' added' : ''}${!isAuthenticated ? ' needs-login' : ''}${isButtonWiggling ? ' wiggle' : ''}`}\n                size=\"lg\"\n                onClick={handleAddToCart}\n                disabled={isAdding}\n              >\n                <i className={`bi ${isAdding ? 'bi-check-circle' : 'bi-cart-plus'} me-2`}></i>\n                {isAuthenticated ? (isAdding ? 'เพิ่มแล้ว!' : 'เพิ่มลงตะกร้า') : 'เข้าสู่ระบบก่อนเพิ่ม'}\n              </Button>\n            </div>\n\n            <div className=\"detail-meta\">\n              <Card>\n                <Card.Body>\n                  <div>\n                    <span>บริการจัดส่ง</span>\n                    <strong>ฟรีในเขตกรุงเทพฯ และปริมณฑล</strong>\n                  </div>\n                  <div>\n                    <span>การรับประกัน</span>\n                    <strong>โครงสร้าง 3 ปี / กลไก 1 ปี</strong>\n                  </div>\n                  <div>\n                    <span>ระยะเวลาการผ่อน</span>\n                    <strong>ผ่อนได้ตั้งแต่ 2 เดือนจนถึง 12 เดือน</strong>\n                  </div>\n                </Card.Body>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </Container>\n    </div>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}